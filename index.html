<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Swift First Step</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/highlight.pack.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/app.css">
  </head>
  <body>
    <div class="container">
      <section>
        <div class="playground-header">
          <h2 class="main-title">Swift Seminar</h2>
        </div>
      </section>
      <section class="env mb20">
        <h2 class="env-title">実行環境</h2>OS X El Capitan 10.11.5 <br> Xcode 8.0 beta(8S128d)
      </section>
      <h3 class="play-title">Seminar1</h3>
      <p class="mb10">※各Stepのプログラムは<a href="https://github.com/code0-sh/SwiftSeminarProgram" target="blank">こちら</a>にあります。</p>
      <section class="playground">
        <div class="play-list">
          <div class="play-list-item">
            <div class="step-header">
              <div class="step-num"><i class="fa fa-plus-square"></i> Step1:プロジェクト作成</div>
            </div>
            <div class="play-code">
              <ul class="guidance">
                <li>Xcodeを起動し、<i class="marker highlight">Create a new Xcode project</i>を選択する。</li><img src="images/step1_xcode_01.png" width="50%">
                <li><i class="marker highlight">Game</i>を選択して<i class="marker highlight">Next</i>を押下する。</li><img src="images/step1_xcode_02.png" width="50%">
                <li>アプリ名、組織名は任意のものを入れて<i class="marker highlight">Next</i>を押下する。</li><img src="images/step1_xcode_03.png" width="50%">
                <li>任意のディレクトリを選択して<i class="marker highlight">Next</i>を押下する。</li><img src="images/step1_xcode_04.png" width="50%">
              </ul>
            </div>
          </div>
        </div>
        <div class="play-list">
          <div class="play-list-item">
            <div class="step-header">
              <div class="step-num"><i class="fa fa-plus-square"></i> Step2:プロジェクト初期化</div>
            </div>
            <div class="play-code">
              <ul class="guidance">
                <li>sksファイル(Actions.sks, GameScene.sks)を削除する。</li>
                <li>GameScene.swift : GameSceneの中身を空にする。<pre><code class="lang-swift">class GameScene: SKScene {
    /// Sceneが表示された際に実行される
    override func didMove(to view: SKView) {
    }
}
</code></pre>

                </li>
                <li>GameViewController.swift : viewDidLoadを以下に変更する。<pre><code class="lang-swift">    override func viewDidLoad() {
        super.viewDidLoad()

        // シーンの作成
        let scene = GameScene()

        // View ControllerのViewをSKView型として取り出す
        let view = self.view as! SKView

        // FPSの表示
        view.showsFPS = true

        // ノード数の表示
        view.showsNodeCount = true

        // シーンのサイズをビューに合わせる
        scene.size = view.frame.size

        // ビュー上にシーンを表示
        view.presentScene(scene)
    }
</code></pre>

                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="play-list">
          <div class="play-list-item">
            <div class="step-header">
              <div class="step-num"><i class="fa fa-plus-square"></i> Step3: 文字を表示する</div>
            </div>
            <div class="play-code">
              <dl class="learn">
                <dt class="learn-title">習得事項</dt>
                <dd class="learn-contents">SKLabelNodeを使って文字を表示できる</dd>
              </dl>
              <dl class="subject mb10">
                <dt class="subject-title">課題</dt>
                <dd class="subject-contents">
                  <div class="mb10"><span>SKLabelNodeを使って文字列「Hello, SpriteKit」を表示する。</span></div>
                  <ul class="ml20">
                    <li>フォント名 Chalkduster</li>
                    <li>文字サイズ 30</li>
                    <li>文字色 green</li>
                    <li>文字の位置 画面の中心</li>
                  </ul>
                </dd>
              </dl>
              <button class="answerBtn mb10">解答例</button>
              <div class="answer hidden"><pre><code class="lang-swift">class GameScene: SKScene {
    /// Sceneが表示された際に実行される
    override func didMove(to view: SKView) {
        // ラベルのフォントを指定しインスタンスを生成する
        let label = SKLabelNode(fontNamed:&quot;Chalkduster&quot;)
        // ラベルに表示する文字列
        label.text = &quot;Hello, SpriteKit&quot;
        // ラベルの文字サイズ
        label.fontSize = 30
        // ラベルの文字色
        label.fontColor = SKColor.green()
        // ラベルの位置
        label.position = CGPoint(x:self.frame.midX, y:self.frame.midY);

        // シーンに追加
        self.addChild(label)

        // 背景色
        self.backgroundColor = SKColor.purple()
    }
}
</code></pre>

              </div>
            </div>
          </div>
        </div>
        <div class="play-list">
          <div class="play-list-item">
            <div class="step-header">
              <div class="step-num"><i class="fa fa-plus-square"></i> Step4: 画像を表示する</div>
            </div>
            <div class="play-code">
              <dl class="learn">
                <dt class="learn-title">習得事項</dt>
                <dd class="learn-contents">SKSpriteNode、SKTextureを使って画像を表示できる。</dd>
              </dl>
              <dl class="subject mb10">
                <dt class="subject-title">課題</dt>
                <dd class="subject-contents">
                  <div class="mb10"><span>画像を表示変更する。</span></div>
                  <ol class="ml20">
                    <li>SKSpriteNodeを使って画像を表示する。</li>
                    <li>SKTextureを使って画像を変更する。</li>
                  </ol>
                </dd>
              </dl>
              <button class="answerBtn mb10">解答例</button>
              <div class="answer hidden">
                <ul class="guidance">
                  <li>Assets.xcassetsに画像ファイル(person.png)をドラッグアンドドロップする。</li><img src="images/step4_xcode_01.png" width="50%"><pre><code class="lang-swift">class GameScene: SKScene {
    /// Sceneが表示された際に実行される
    override func didMove(to view: SKView) {
        // スプライトを作成
        let person = SKSpriteNode(imageNamed: &quot;person.png&quot;)
        // スプライトのサイズ
        person.size = CGSize(width: 100, height: 100)
        // スプライトの位置
        person.position = CGPoint(x:self.frame.midX, y:self.frame.midY)
        // スプライトを配置する
        self.addChild(person)
        // 画面の背景色
        self.backgroundColor = UIColor.lightGray()
    }
}
</code></pre>

                  <li>Assets.xcassetsに画像ファイル(airplane.png)をドラッグアンドドロップする。</li><img src="images/step4_xcode_02.png" width="50%"><pre><code class="lang-swift">class GameScene: SKScene {
    /// Sceneが表示された際に実行される
    override func didMove(to view: SKView) {
        // スプライトを作成
        let sprite = SKSpriteNode(imageNamed: &quot;person.png&quot;)
        // スプライトのサイズ
        sprite.size = CGSize(width: 50, height: 50)
        // スプライトの位置
        sprite.position = CGPoint(x:self.frame.midX, y:self.frame.midY)
        // スプライトを配置する
        self.addChild(sprite)
        // 画面の背景色
        self.backgroundColor = UIColor.lightGray()

        // 画像の差し替え
        let texture = SKTexture(imageNamed: &quot;airplane.png&quot;)
        sprite.texture = texture

        // 色をブレンドする
        sprite.color = #colorLiteral(red: 0.1991284192, green: 0.6028449535, blue: 0.9592232704, alpha: 1)
        sprite.colorBlendFactor = 1
    }
}
</code></pre>

                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="play-list">
          <div class="play-list-item">
            <div class="step-header">
              <div class="step-num"><i class="fa fa-plus-square"></i> Step5: アニメーション</div>
            </div>
            <div class="play-code">
              <dl class="learn">
                <dt class="learn-title">習得事項</dt>
                <dd class="learn-contents">SKActionを使ってのアニメーションができる</dd>
              </dl>
              <dl class="subject mb10">
                <dt class="subject-title">課題</dt>
                <dd class="subject-contents">
                  <div class="mb10"><span>SKActionを使って対象物にアニメーションを付ける</span></div>
                  <ol class="ml20">
                    <li>SKSpriteNodeを使用しアニメーションの対象物を作成する</li>
                    <li>SKActionを使用しアニメーションを作成する</li>
                    <li>作成したアニメーションを対象物に設定する</li>
                  </ol>
                </dd>
              </dl>
              <button class="answerBtn mb10">解答例</button>
              <div class="answer hidden">
                <ul class="guidance">
                  <li>Assets.xcassetsに画像ファイル(background.png)をドラッグアンドドロップする。</li><img src="images/step5_xcode_01.png" width="50%"><pre><code class="lang-swift">class GameScene: SKScene {
    /// 背景画像を設定する
    func setupBackground(baseNode: SKNode) {
        // 背景画像からテクスチャを作成
        let texture = SKTexture(imageNamed: &quot;background&quot;)
        // フィルタリングモード（テクスチャの本来のサイズ以外で描画される場合に使用される）
        // .linear クォリティー高い
        // .nearest クォリティー低い
        texture.filteringMode = .nearest

        // 必要な画像枚数を算出
        let needHeightNumber: CGFloat = ceil(self.frame.size.height / texture.size().height)
        let needWidthNumber: CGFloat = ceil(self.frame.size.width / texture.size().width)

        // アニメーションを作成
        let moveAnim = SKAction.moveBy(x: 0.0, y: -texture.size().height, duration: TimeInterval(texture.size().height / 10.0))
        let resetAnim = SKAction.moveBy(x: 0.0, y: texture.size().height, duration: 0.0)
        let repeatForeverAnim = SKAction.repeatForever(SKAction.sequence([moveAnim, resetAnim]))

        // 画像の配置とアニメーションを設定
        for i in 0 ... Int(needWidthNumber) {
            for j in 0 ... Int(needHeightNumber) {
                let sprite = SKSpriteNode(texture: texture)
                sprite.zPosition = -100
                sprite.position = CGPoint(x: CGFloat(i) * sprite.size.width, y: CGFloat(j) * sprite.size.height)
                sprite.speed = 20
                sprite.run(repeatForeverAnim)
                baseNode.addChild(sprite)
            }
        }
    }
    /// Sceneが表示された際に実行される
    override func didMove(to view: SKView) {
        let baseNode = SKNode()
        self.setupBackground(baseNode: baseNode)
        self.addChild(baseNode)
    }
}
</code></pre>

                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="play-list">
          <div class="play-list-item">
            <div class="step-header">
              <div class="step-num"><i class="fa fa-plus-square"></i> Step6: 重力と衝突</div>
            </div>
            <div class="play-code">
              <ul class="guidance">
                <li>Assets.xcassetsに画像ファイル(enemy.png)をドラッグアンドドロップする。</li><img src="images/step6_xcode_01.png" width="50%"><pre><code class="lang-swift">class GameScene: SKScene {
    // 衝突判定用のビット値
    struct ColliderType {
        static let Enemy: UInt32 = (1 &lt;&lt; 0)
        static let World: UInt32 = (1 &lt;&lt; 1)
    }

    func setupEnemy(baseNode: SKNode) {
        // エネミー画像からテクスチャを作成
        let texture = SKTexture(imageNamed: &quot;enemy&quot;)
        // フィルタリングモード（テクスチャの本来のサイズ以外で描画される場合に使用される）
        // .Linear クォリティー高い
        // .Nearest クォリティー低
        texture.filteringMode = .nearest

        // エネミー画像の半径
        let radius: CGFloat = 10

        for _ in 0..&lt;10 {
            let sprite = SKSpriteNode(texture: texture)
            sprite.size = CGSize(width: radius*2, height: radius*2)
            let randIntX = radius + (CGFloat)(arc4random_uniform((UInt32)(self.frame.width - radius * 2)))
            let randIntY = radius + (CGFloat)(arc4random_uniform((UInt32)(self.frame.height - radius * 2)))
            sprite.position = CGPoint(x:randIntX, y:randIntY)

            // 重力
            sprite.physicsBody = SKPhysicsBody(circleOfRadius: radius)
            sprite.physicsBody?.restitution = 1.0 // 反発係数
            sprite.physicsBody?.linearDamping = 0.0 // 空気抵抗
            sprite.physicsBody?.mass = 1.0 // 質量
            sprite.physicsBody?.friction = 0.0 // 摩擦

            // 物体種別
            sprite.physicsBody?.categoryBitMask = ColliderType.Enemy
            // どの物体と接触した場合に衝突させるか
            sprite.physicsBody?.collisionBitMask = ColliderType.Enemy | ColliderType.World
            // どの物体と接触した場合にイベントを発生させるか
            sprite.physicsBody?.contactTestBitMask = ColliderType.Enemy

            baseNode.addChild(sprite)
        }
    }
    // 接触した時のイベント
    func didBegin(_ contact: SKPhysicsContact) {
        contact.bodyA.node?.removeFromParent()
    }

    /// Sceneが表示された際に実行される
    override func didMove(to view: SKView) {
        let baseNode = SKNode()
        self.setupEnemy(baseNode: baseNode)

        // 重力
        self.physicsWorld.gravity = CGVector(dx: 0.0, dy: -0.5)
        self.physicsWorld.contactDelegate = self
        self.physicsBody = SKPhysicsBody(edgeLoopFrom: CGRect(x: 0, y: 0, width: frame.width, height: frame.height))
        self.physicsBody?.restitution = 1.0 // 反発係数
        self.physicsBody?.linearDamping = 0.0 // 空気抵抗
        self.physicsBody?.friction = 0.0 // 摩擦
        self.name = &quot;frame&quot;

        // 物体種別
        self.physicsBody?.categoryBitMask = ColliderType.World
        // どの物体と接触した場合に衝突させるか
        self.physicsBody?.collisionBitMask = ColliderType.Enemy

        self.addChild(baseNode)
    }
}
</code></pre>

              </ul>
            </div>
          </div>
        </div>
      </section>
    </div>
    <div id="react"></div>
    <script src="js/react-with-addons-0.13.1.js"></script>
    <script src="js/bundle.js"></script>
    <script src="js/highlight.pack.js"></script>
    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </body>
</html>